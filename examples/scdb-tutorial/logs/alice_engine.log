2025-12-15 16:27:47.584 [info] [main.cc:main:312] [scqlengine] Engine version: 0.9.5dev.20251130-21:28:14.5de28ec
2025-12-15 16:27:47.587 [info] [main.cc:BuildRouter:117] [scqlengine] Building EmbedRouter from json conf
2025-12-15 16:27:47.589 [info] [session_manager.cc:WatchSessionTimeoutThread:275] [scqlengine] WatchSessionTimeoutThread startup, session default timeout=1800s
2025-12-15 16:27:47.589 [info] [thread_pool.cc:ThreadPool:30] [scqlengine] Create a fixed thread pool with size 192
2025-12-15 16:27:47.598 [info] [main.cc:main:342] [scqlengine] Adding EngineService into brpc server
2025-12-15 16:27:47.600 [info] [main.cc:main:352] [scqlengine] Adding MetricsService into brpc server
2025-12-15 16:27:47.600 [info] [main.cc:main:365] [scqlengine] Adding MuxReceiverService into main server...
2025-12-15 16:27:47.601 [info] [main.cc:main:370] [scqlengine] Adding ErrorCollectorService into main server...
2025-12-15 16:27:47.614 [warning] [server.cpp:BRPC:1248] [scqlengine] Builtin services are disabled according to ServerOptions.has_builtin_services
2025-12-15 16:27:47.615 [info] [main.cc:main:395] [scqlengine] Started engine rpc server success, listen on: 0.0.0.0:8003
2025-12-15 16:27:47.615 [warning] [controller.cpp:BRPC:1618] [scqlengine] SIGTERM was installed with 1
2025-12-15 16:28:04.368 [info] [session_manager.cc:CreateSession:131] [scqlengine] create session(f9d13ba1-d98f-11f0-a46f-0242ac110007) succ, cost(15ms), current running session=1
2025-12-15 16:28:04.368 [info] [engine_service_impl.cc:CheckGraphChecksum:177] [job(f9d13ba1-d98f-11f0-a46f-0242ac110007)] skip checking graph checksum
2025-12-15 16:28:04.373 [info] [engine_service_impl.cc:RunExecutionPlan:283] [job(f9d13ba1-d98f-11f0-a46f-0242ac110007)] [RunExecutionPlan] Session created successfully, start to run plan, client = 127.0.0.1:42518
RunExecutionPlanRequest = {"job_params":{"party_code":"alice","parties":[{"code":"alice","name":"alice","host":"localhost:8003"},{"code":"bob","name":"bob","host":"localhost:8004","rank":1}],"job_id":"f9d13ba1-d98f-11f0-a46f-0242ac110007","spu_runtime_cfg":{"protocol":2,"field":2,"public_random_seed":"8566195786011296438"}},"graph":{"nodes":{"0":{"node_name":"runsql.0","op_type":"RunSQL","outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"sql":{"t":{"name":".0","elem_type":8,"string_data":["select a.credit_rank,a.id,a.income from default.user_credit as a where a.age\u003e=20;"]}},"table_refs":{"t":{"name":".0","shape":{"dim":[{"dim_value":"1"}]},"elem_type":8,"string_data":["default.user_credit"]}}}},"2":{"node_name":"join.2","op_type":"Join","inputs":{"Left":{"tensors":[{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2}]},"Right":{"tensors":[{"name":"hive_test.user_stats.id.3","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"LeftJoinIndex":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RightJoinIndex":{"tensors":[{"name":"hive_test.user_stats.id.7","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","shape":{"dim":[{"dim_value":"2"}]},"elem_type":8,"string_data":["alice","bob"]}},"join_type":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}},"psi_algorithm":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}}}},"3":{"node_name":"filter_by_index.3","op_type":"FilterByIndex","inputs":{"Data":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RowsIndexFilter":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}}},"5":{"node_name":"copy.5","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.order_amount.12","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"6":{"node_name":"copy.6","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.is_active.11","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"7":{"node_name":"publish.7","op_type":"Publish","inputs":{"In":{"tensors":[{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"ID.13","elem_type":8,"annotation":{"status":1},"string_data":["ID"]},{"name":"credit_rank.14","elem_type":8,"annotation":{"status":1},"string_data":["credit_rank"]},{"name":"income.15","elem_type":8,"annotation":{"status":1},"string_data":["income"]},{"name":"order_amount.17","elem_type":8,"annotation":{"status":1},"string_data":["order_amount"]},{"name":"is_active.19","elem_type":8,"annotation":{"status":1},"string_data":["is_active"]}]}}}},"policy":{"worker_num":1,"pipelines":[{"subdags":[{"jobs":[{"node_ids":["0"]}]},{},{"jobs":[{"node_ids":["2"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["3"]}]},{},{"jobs":[{"node_ids":["5"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["6"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["7"]}]}]}]},"sub_graph_checksum":"dcee3fcd8ae8fd1fda706e9cc3161d1e2224e29e7b9bd1429fc3a08a3e41c3f8"},"graph_checksum":{},"callback_url":"http://localhost:8080/cb/engine"}
2025-12-15 16:28:04.374 [info] [engine_service_impl.cc:RunPlanCore:476] [job(f9d13ba1-d98f-11f0-a46f-0242ac110007)] session(f9d13ba1-d98f-11f0-a46f-0242ac110007) start to execute pipeline(0) batch(0)
2025-12-15 16:28:04.375 [info] [engine_service_impl.cc:RunPlanCore:488] [job(f9d13ba1-d98f-11f0-a46f-0242ac110007)] session(f9d13ba1-d98f-11f0-a46f-0242ac110007) start to execute node(runsql.0) op(RunSQL) pipeline(0) batch(0)
2025-12-15 16:28:04.620 [error] [engine_service_impl.cc:RunPlanSync:589] [job(f9d13ba1-d98f-11f0-a46f-0242ac110007)] RunExecutionPlan run jobs(f9d13ba1-d98f-11f0-a46f-0242ac110007) failed, catch std::exception=[engine/datasource/arrow_sql_adaptor.cc:149] IOError: Query execution failed: Parser Error: syntax error at or near "type"

LINE 1: type.googleapis.com/arrow.flight.protocol.sql.CommandStatem...
        ^. Detail: Failed. Detail: Failed
2025-12-15 16:28:04.621 [warning] [session_manager.cc:CompareAndSetState:264] [scqlengine] session(f9d13ba1-d98f-11f0-a46f-0242ac110007), failed to transition state from COMPUTATION_FINISHED to SUCCEEDED. Current state was not the expected one.
2025-12-15 16:28:04.621 [info] [session_manager.cc:RemoveSession:217] [scqlengine] session(f9d13ba1-d98f-11f0-a46f-0242ac110007) removed, running_cost(269ms), current running session=0
2025-12-15 16:28:04.622 [warning] [channel.h:~Channel:163] [scqlengine] Channel destructor is called before WaitLinkTaskFinish, try stop send thread
2025-12-15 16:28:04.626 [warning] [session_manager.cc:GetSession:145] [scqlengine] session(f9d13ba1-d98f-11f0-a46f-0242ac110007) not exists. default return nullptr.
2025-12-15 16:30:19.511 [info] [session_manager.cc:CreateSession:131] [scqlengine] create session(4a2e1b2c-d990-11f0-a46f-0242ac110007) succ, cost(347ms), current running session=1
2025-12-15 16:30:19.511 [info] [engine_service_impl.cc:CheckGraphChecksum:177] [job(4a2e1b2c-d990-11f0-a46f-0242ac110007)] skip checking graph checksum
2025-12-15 16:30:19.516 [info] [engine_service_impl.cc:RunExecutionPlan:283] [job(4a2e1b2c-d990-11f0-a46f-0242ac110007)] [RunExecutionPlan] Session created successfully, start to run plan, client = 127.0.0.1:56986
RunExecutionPlanRequest = {"job_params":{"party_code":"alice","parties":[{"code":"alice","name":"alice","host":"localhost:8003"},{"code":"bob","name":"bob","host":"localhost:8004","rank":1}],"job_id":"4a2e1b2c-d990-11f0-a46f-0242ac110007","spu_runtime_cfg":{"protocol":2,"field":2,"public_random_seed":"1026345501476269805"}},"graph":{"nodes":{"0":{"node_name":"runsql.0","op_type":"RunSQL","outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"sql":{"t":{"name":".0","elem_type":8,"string_data":["select a.credit_rank,a.id,a.income from default.user_credit as a where a.age\u003e=20;"]}},"table_refs":{"t":{"name":".0","shape":{"dim":[{"dim_value":"1"}]},"elem_type":8,"string_data":["default.user_credit"]}}}},"2":{"node_name":"join.2","op_type":"Join","inputs":{"Left":{"tensors":[{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2}]},"Right":{"tensors":[{"name":"hive_test.user_stats.id.3","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"LeftJoinIndex":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RightJoinIndex":{"tensors":[{"name":"hive_test.user_stats.id.7","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","shape":{"dim":[{"dim_value":"2"}]},"elem_type":8,"string_data":["alice","bob"]}},"join_type":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}},"psi_algorithm":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}}}},"3":{"node_name":"filter_by_index.3","op_type":"FilterByIndex","inputs":{"Data":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RowsIndexFilter":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}}},"5":{"node_name":"copy.5","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.order_amount.12","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"6":{"node_name":"copy.6","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.is_active.11","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"7":{"node_name":"publish.7","op_type":"Publish","inputs":{"In":{"tensors":[{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"ID.13","elem_type":8,"annotation":{"status":1},"string_data":["ID"]},{"name":"credit_rank.14","elem_type":8,"annotation":{"status":1},"string_data":["credit_rank"]},{"name":"income.15","elem_type":8,"annotation":{"status":1},"string_data":["income"]},{"name":"order_amount.17","elem_type":8,"annotation":{"status":1},"string_data":["order_amount"]},{"name":"is_active.19","elem_type":8,"annotation":{"status":1},"string_data":["is_active"]}]}}}},"policy":{"worker_num":1,"pipelines":[{"subdags":[{"jobs":[{"node_ids":["0"]}]},{},{"jobs":[{"node_ids":["2"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["3"]}]},{},{"jobs":[{"node_ids":["5"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["6"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["7"]}]}]}]},"sub_graph_checksum":"dcee3fcd8ae8fd1fda706e9cc3161d1e2224e29e7b9bd1429fc3a08a3e41c3f8"},"graph_checksum":{},"callback_url":"http://localhost:8080/cb/engine"}
2025-12-15 16:30:19.516 [info] [engine_service_impl.cc:RunPlanCore:476] [job(4a2e1b2c-d990-11f0-a46f-0242ac110007)] session(4a2e1b2c-d990-11f0-a46f-0242ac110007) start to execute pipeline(0) batch(0)
2025-12-15 16:30:19.517 [info] [engine_service_impl.cc:RunPlanCore:488] [job(4a2e1b2c-d990-11f0-a46f-0242ac110007)] session(4a2e1b2c-d990-11f0-a46f-0242ac110007) start to execute node(runsql.0) op(RunSQL) pipeline(0) batch(0)
2025-12-15 16:30:19.524 [error] [engine_service_impl.cc:RunPlanSync:589] [job(4a2e1b2c-d990-11f0-a46f-0242ac110007)] RunExecutionPlan run jobs(4a2e1b2c-d990-11f0-a46f-0242ac110007) failed, catch std::exception=[engine/datasource/arrow_sql_adaptor.cc:149] IOError: Query execution failed: Parser Error: syntax error at or near "default"

LINE 1: select a.credit_rank,a.id,a.income from default.user_credit as a where a.age>=20;
                                                ^. Detail: Failed. Detail: Failed
2025-12-15 16:30:19.525 [warning] [engine_service_impl.cc:ReportErrorToPeers:672] [job(4a2e1b2c-d990-11f0-a46f-0242ac110007)] sync error to peer=(bob,localhost:8004) failed: status: code: 141
message: "no session for job_id=4a2e1b2c-d990-11f0-a46f-0242ac110007"

2025-12-15 16:30:19.525 [warning] [session_manager.cc:CompareAndSetState:264] [scqlengine] session(4a2e1b2c-d990-11f0-a46f-0242ac110007), failed to transition state from COMPUTATION_FINISHED to SUCCEEDED. Current state was not the expected one.
2025-12-15 16:30:19.525 [info] [session_manager.cc:RemoveSession:217] [scqlengine] session(4a2e1b2c-d990-11f0-a46f-0242ac110007) removed, running_cost(362ms), current running session=0
2025-12-15 16:30:19.526 [warning] [channel.h:~Channel:163] [scqlengine] Channel destructor is called before WaitLinkTaskFinish, try stop send thread
2025-12-15 16:36:51.086 [warning] [listener.cc:GetListener:60] [scqlengine] Listener for link_id:33c7e1f8-d991-11f0-a46f-0242ac110007 not exist.
2025-12-15 16:36:51.526 [info] [session_manager.cc:CreateSession:131] [scqlengine] create session(33c7e1f8-d991-11f0-a46f-0242ac110007) succ, cost(439ms), current running session=1
2025-12-15 16:36:51.526 [info] [engine_service_impl.cc:CheckGraphChecksum:177] [job(33c7e1f8-d991-11f0-a46f-0242ac110007)] skip checking graph checksum
2025-12-15 16:36:51.531 [info] [engine_service_impl.cc:RunExecutionPlan:283] [job(33c7e1f8-d991-11f0-a46f-0242ac110007)] [RunExecutionPlan] Session created successfully, start to run plan, client = 127.0.0.1:34120
RunExecutionPlanRequest = {"job_params":{"party_code":"alice","parties":[{"code":"alice","name":"alice","host":"localhost:8003"},{"code":"bob","name":"bob","host":"localhost:8004","rank":1}],"job_id":"33c7e1f8-d991-11f0-a46f-0242ac110007","spu_runtime_cfg":{"protocol":2,"field":2,"public_random_seed":"5610888430483297897"}},"graph":{"nodes":{"0":{"node_name":"runsql.0","op_type":"RunSQL","outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"sql":{"t":{"name":".0","elem_type":8,"string_data":["select a.credit_rank,a.id,a.income from default.user_credit as a where a.age\u003e=20;"]}},"table_refs":{"t":{"name":".0","shape":{"dim":[{"dim_value":"1"}]},"elem_type":8,"string_data":["default.user_credit"]}}}},"2":{"node_name":"join.2","op_type":"Join","inputs":{"Left":{"tensors":[{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2}]},"Right":{"tensors":[{"name":"hive_test.user_stats.id.3","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"LeftJoinIndex":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RightJoinIndex":{"tensors":[{"name":"hive_test.user_stats.id.7","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","shape":{"dim":[{"dim_value":"2"}]},"elem_type":8,"string_data":["alice","bob"]}},"join_type":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}},"psi_algorithm":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}}}},"3":{"node_name":"filter_by_index.3","op_type":"FilterByIndex","inputs":{"Data":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RowsIndexFilter":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}}},"5":{"node_name":"copy.5","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.order_amount.12","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"6":{"node_name":"copy.6","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.is_active.11","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"7":{"node_name":"publish.7","op_type":"Publish","inputs":{"In":{"tensors":[{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"ID.13","elem_type":8,"annotation":{"status":1},"string_data":["ID"]},{"name":"credit_rank.14","elem_type":8,"annotation":{"status":1},"string_data":["credit_rank"]},{"name":"income.15","elem_type":8,"annotation":{"status":1},"string_data":["income"]},{"name":"order_amount.17","elem_type":8,"annotation":{"status":1},"string_data":["order_amount"]},{"name":"is_active.19","elem_type":8,"annotation":{"status":1},"string_data":["is_active"]}]}}}},"policy":{"worker_num":1,"pipelines":[{"subdags":[{"jobs":[{"node_ids":["0"]}]},{},{"jobs":[{"node_ids":["2"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["3"]}]},{},{"jobs":[{"node_ids":["5"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["6"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["7"]}]}]}]},"sub_graph_checksum":"dcee3fcd8ae8fd1fda706e9cc3161d1e2224e29e7b9bd1429fc3a08a3e41c3f8"},"graph_checksum":{},"callback_url":"http://localhost:8080/cb/engine"}
2025-12-15 16:36:51.532 [info] [engine_service_impl.cc:RunPlanCore:476] [job(33c7e1f8-d991-11f0-a46f-0242ac110007)] session(33c7e1f8-d991-11f0-a46f-0242ac110007) start to execute pipeline(0) batch(0)
2025-12-15 16:36:51.533 [info] [engine_service_impl.cc:RunPlanCore:488] [job(33c7e1f8-d991-11f0-a46f-0242ac110007)] session(33c7e1f8-d991-11f0-a46f-0242ac110007) start to execute node(runsql.0) op(RunSQL) pipeline(0) batch(0)
2025-12-15 16:36:51.541 [error] [engine_service_impl.cc:RunPlanSync:589] [job(33c7e1f8-d991-11f0-a46f-0242ac110007)] RunExecutionPlan run jobs(33c7e1f8-d991-11f0-a46f-0242ac110007) failed, catch std::exception=[engine/datasource/arrow_sql_adaptor.cc:149] IOError: Query execution failed: Parser Error: syntax error at or near "default"

LINE 1: select a.credit_rank,a.id,a.income from default.user_credit as a where a.age>=20;
                                                ^. Detail: Failed. Detail: Failed
2025-12-15 16:36:51.542 [warning] [engine_service_impl.cc:ReportErrorToPeers:672] [job(33c7e1f8-d991-11f0-a46f-0242ac110007)] sync error to peer=(bob,localhost:8004) failed: status: code: 141
message: "no session for job_id=33c7e1f8-d991-11f0-a46f-0242ac110007"

2025-12-15 16:36:51.542 [warning] [session_manager.cc:CompareAndSetState:264] [scqlengine] session(33c7e1f8-d991-11f0-a46f-0242ac110007), failed to transition state from COMPUTATION_FINISHED to SUCCEEDED. Current state was not the expected one.
2025-12-15 16:36:51.542 [info] [session_manager.cc:RemoveSession:217] [scqlengine] session(33c7e1f8-d991-11f0-a46f-0242ac110007) removed, running_cost(455ms), current running session=0
2025-12-15 16:36:51.542 [warning] [channel.h:~Channel:163] [scqlengine] Channel destructor is called before WaitLinkTaskFinish, try stop send thread
2025-12-15 16:44:10.348 [warning] [listener.cc:GetListener:60] [scqlengine] Listener for link_id:399aa49a-d992-11f0-a46f-0242ac110007 not exist.
2025-12-15 16:44:10.453 [info] [session_manager.cc:CreateSession:131] [scqlengine] create session(399aa49a-d992-11f0-a46f-0242ac110007) succ, cost(104ms), current running session=1
2025-12-15 16:44:10.453 [info] [engine_service_impl.cc:CheckGraphChecksum:177] [job(399aa49a-d992-11f0-a46f-0242ac110007)] skip checking graph checksum
2025-12-15 16:44:10.458 [info] [engine_service_impl.cc:RunExecutionPlan:283] [job(399aa49a-d992-11f0-a46f-0242ac110007)] [RunExecutionPlan] Session created successfully, start to run plan, client = 127.0.0.1:52328
RunExecutionPlanRequest = {"job_params":{"party_code":"alice","parties":[{"code":"alice","name":"alice","host":"localhost:8003"},{"code":"bob","name":"bob","host":"localhost:8004","rank":1}],"job_id":"399aa49a-d992-11f0-a46f-0242ac110007","spu_runtime_cfg":{"protocol":2,"field":2,"public_random_seed":"8716064672458806741"}},"graph":{"nodes":{"0":{"node_name":"runsql.0","op_type":"RunSQL","outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"sql":{"t":{"name":".0","elem_type":8,"string_data":["select a.credit_rank,a.id,a.income from default.user_credit as a where a.age\u003e=20;"]}},"table_refs":{"t":{"name":".0","shape":{"dim":[{"dim_value":"1"}]},"elem_type":8,"string_data":["default.user_credit"]}}}},"2":{"node_name":"join.2","op_type":"Join","inputs":{"Left":{"tensors":[{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2}]},"Right":{"tensors":[{"name":"hive_test.user_stats.id.3","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"LeftJoinIndex":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RightJoinIndex":{"tensors":[{"name":"hive_test.user_stats.id.7","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","shape":{"dim":[{"dim_value":"2"}]},"elem_type":8,"string_data":["alice","bob"]}},"join_type":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}},"psi_algorithm":{"t":{"name":".0","elem_type":4,"int64_data":["0"]}}}},"3":{"node_name":"filter_by_index.3","op_type":"FilterByIndex","inputs":{"Data":{"tensors":[{"name":"hive_test.user_credit.credit_rank.0","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.1","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":2},{"name":"hive_test.user_credit.income.2","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]},"RowsIndexFilter":{"tensors":[{"name":"hive_test.user_credit.id.6","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}}},"5":{"node_name":"copy.5","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.order_amount.12","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"6":{"node_name":"copy.6","op_type":"Copy","inputs":{"In":{"tensors":[{"name":"hive_test.user_stats.is_active.11","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"attributes":{"input_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["bob"]}},"output_party_codes":{"t":{"name":".0","elem_type":8,"string_data":["alice"]}}}},"7":{"node_name":"publish.7","op_type":"Publish","inputs":{"In":{"tensors":[{"name":"hive_test.user_credit.id.9","elem_type":8,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.credit_rank.8","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_credit.income.10","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.order_amount.16","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1},{"name":"hive_test.user_stats.is_active.18","elem_type":4,"option":1,"annotation":{"status":1},"ref_num":1}]}},"outputs":{"Out":{"tensors":[{"name":"ID.13","elem_type":8,"annotation":{"status":1},"string_data":["ID"]},{"name":"credit_rank.14","elem_type":8,"annotation":{"status":1},"string_data":["credit_rank"]},{"name":"income.15","elem_type":8,"annotation":{"status":1},"string_data":["income"]},{"name":"order_amount.17","elem_type":8,"annotation":{"status":1},"string_data":["order_amount"]},{"name":"is_active.19","elem_type":8,"annotation":{"status":1},"string_data":["is_active"]}]}}}},"policy":{"worker_num":1,"pipelines":[{"subdags":[{"jobs":[{"node_ids":["0"]}]},{},{"jobs":[{"node_ids":["2"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["3"]}]},{},{"jobs":[{"node_ids":["5"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["6"]}],"need_call_barrier_after_jobs":true},{"jobs":[{"node_ids":["7"]}]}]}]},"sub_graph_checksum":"dcee3fcd8ae8fd1fda706e9cc3161d1e2224e29e7b9bd1429fc3a08a3e41c3f8"},"graph_checksum":{},"callback_url":"http://localhost:8080/cb/engine"}
2025-12-15 16:44:10.458 [info] [engine_service_impl.cc:RunPlanCore:476] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) start to execute pipeline(0) batch(0)
2025-12-15 16:44:10.459 [info] [engine_service_impl.cc:RunPlanCore:488] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) start to execute node(runsql.0) op(RunSQL) pipeline(0) batch(0)
2025-12-15 16:44:10.481 [warning] [datasource_adaptor.cc:ConvertDataTypeToExpected:172] [job(399aa49a-d992-11f0-a46f-0242ac110007)] arrow type mismatch, convert from int32 to int64
2025-12-15 16:44:10.506 [warning] [datasource_adaptor.cc:ConvertDataTypeToExpected:172] [job(399aa49a-d992-11f0-a46f-0242ac110007)] arrow type mismatch, convert from string to large_string
2025-12-15 16:44:10.506 [warning] [datasource_adaptor.cc:ConvertDataTypeToExpected:172] [job(399aa49a-d992-11f0-a46f-0242ac110007)] arrow type mismatch, convert from int32 to int64
2025-12-15 16:44:10.507 [info] [run_sql.cc:Execute:74] [job(399aa49a-d992-11f0-a46f-0242ac110007)] get result row=16, column=3
2025-12-15 16:44:10.507 [info] [engine_service_impl.cc:RunPlanCore:504] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) finished executing node(runsql.0), op(RunSQL), cost(47)ms
2025-12-15 16:44:10.507 [info] [engine_service_impl.cc:RunPlanCore:488] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) start to execute node(join.2) op(Join) pipeline(0) batch(0)
2025-12-15 16:44:10.507 [info] [join.cc:Execute:88] [job(399aa49a-d992-11f0-a46f-0242ac110007)] use Rr22Psi as default psi type
2025-12-15 16:44:10.509 [info] [rr22_psi.cc:Prepare:130] [scqlengine] mask size: 6
2025-12-15 16:44:10.509 [info] [thread_pool.cc:ThreadPool:30] [scqlengine] Create a fixed thread pool with size 191
2025-12-15 16:44:10.518 [info] [rr22_oprf.cc:Init:413] [scqlengine] baxos_size:59
2025-12-15 16:44:10.518 [info] [rr22_oprf.cc:Init:421] [scqlengine] begin vole recv
2025-12-15 16:44:10.564 [info] [rr22_oprf.cc:Init:423] [scqlengine] end vole recv
2025-12-15 16:44:10.564 [info] [rr22_oprf.cc:RecvFast:480] [scqlengine] solve begin
2025-12-15 16:44:10.564 [info] [baxos.cc:ImplParSolve:161] [scqlengine] item size:16 paxos size:59 num_bins_:1, items_per_bin_:16 idxType:1
2025-12-15 16:44:10.564 [info] [rr22_oprf.cc:RecvFast:484] [scqlengine] solve end
2025-12-15 16:44:10.564 [info] [rr22_oprf.cc:RecvFast:529] [scqlengine] begin p xor a
2025-12-15 16:44:10.564 [info] [rr22_oprf.cc:operator():509] [scqlengine] begin compute self oprf
2025-12-15 16:44:10.564 [info] [rr22_oprf.cc:operator():523] [scqlengine] call aes crhash
2025-12-15 16:44:10.565 [info] [rr22_oprf.cc:operator():526] [scqlengine] end compute self oprf
2025-12-15 16:44:10.565 [info] [rr22_oprf.cc:RecvFast:538] [scqlengine] end p xor a
2025-12-15 16:44:10.565 [info] [rr22_psi.cc:GetIntersection:164] [scqlengine] get intersection begin
2025-12-15 16:44:10.565 [info] [rr22_utils.cc:GetIntersectionReceiver:78] [scqlengine] recv rr22 oprf begin
2025-12-15 16:44:10.565 [info] [rr22_utils.cc:GetIntersectionReceiver:81] [scqlengine] recv rr22 oprf finished: 78 vector:13
2025-12-15 16:44:10.566 [info] [rr22_psi.cc:GetIntersection:170] [scqlengine] get intersection end
2025-12-15 16:44:10.566 [info] [rr22_psi.cc:GetIntersection:172] [scqlengine] get intersection post f
2025-12-15 16:44:10.566 [info] [join.cc:Rr22PsiJoin:374] [job(399aa49a-d992-11f0-a46f-0242ac110007)] RR22 PSI Join finish, my_party_code:alice, my_rank:0, total self_item_count:16, total peer_item_count:13, result_size:10
2025-12-15 16:44:10.566 [info] [engine_service_impl.cc:RunPlanCore:504] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) finished executing node(join.2), op(Join), cost(59)ms
2025-12-15 16:44:10.566 [info] [engine_service_impl.cc:RunPlanCore:488] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) start to execute node(filter_by_index.3) op(FilterByIndex) pipeline(0) batch(0)
2025-12-15 16:44:10.567 [info] [engine_service_impl.cc:RunPlanCore:504] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) finished executing node(filter_by_index.3), op(FilterByIndex), cost(0)ms
2025-12-15 16:44:10.567 [info] [engine_service_impl.cc:RunPlanCore:488] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) start to execute node(copy.5) op(Copy) pipeline(0) batch(0)
2025-12-15 16:44:10.567 [info] [copy.cc:Execute:154] [job(399aa49a-d992-11f0-a46f-0242ac110007)] received 10 rows in batch 1, 10 rows in total.
2025-12-15 16:44:10.568 [info] [engine_service_impl.cc:RunPlanCore:504] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) finished executing node(copy.5), op(Copy), cost(0)ms
2025-12-15 16:44:10.568 [info] [engine_service_impl.cc:RunPlanCore:488] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) start to execute node(copy.6) op(Copy) pipeline(0) batch(0)
2025-12-15 16:44:10.568 [info] [copy.cc:Execute:154] [job(399aa49a-d992-11f0-a46f-0242ac110007)] received 10 rows in batch 1, 10 rows in total.
2025-12-15 16:44:10.569 [info] [engine_service_impl.cc:RunPlanCore:504] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) finished executing node(copy.6), op(Copy), cost(0)ms
2025-12-15 16:44:10.569 [info] [engine_service_impl.cc:RunPlanCore:488] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) start to execute node(publish.7) op(Publish) pipeline(0) batch(0)
2025-12-15 16:44:10.569 [info] [engine_service_impl.cc:RunPlanCore:504] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) finished executing node(publish.7), op(Publish), cost(0)ms
2025-12-15 16:44:10.569 [info] [engine_service_impl.cc:RunPlanCore:539] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) finished executing pipeline(0) batch(0)
2025-12-15 16:44:10.569 [info] [engine_service_impl.cc:RunPlanCore:546] [job(399aa49a-d992-11f0-a46f-0242ac110007)] session(399aa49a-d992-11f0-a46f-0242ac110007) run plan policy succ
2025-12-15 16:44:10.570 [info] [engine_service_impl.cc:RunPlanSync:579] [job(399aa49a-d992-11f0-a46f-0242ac110007)] RunExecutionPlan success, sessionID=399aa49a-d992-11f0-a46f-0242ac110007
2025-12-15 16:44:10.570 [info] [session_manager.cc:CompareAndSetState:260] [scqlengine] session(399aa49a-d992-11f0-a46f-0242ac110007), state transitioned from COMPUTATION_FINISHED to SUCCEEDED successfully.
2025-12-15 16:44:10.570 [info] [session_manager.cc:RemoveSession:217] [scqlengine] session(399aa49a-d992-11f0-a46f-0242ac110007) removed, running_cost(222ms), current running session=0
